apiVersion: v1
kind: ConfigMap
metadata:
  name: postgres-hba
  namespace: tasklistapp
  labels:
    app.kubernetes.io/name: postgresql
    app.kubernetes.io/instance: postgresdb
    app.kubernetes.io/component: database
    app.kubernetes.io/part-of: tasklistapp
    app.kubernetes.io/managed-by: argocd
data:
  postgresql.conf: |
    # PostgreSQL configuration file

    # Connection settings
    listen_addresses = '*'
    port = 5432

    # Authentication
    hba_file = '/etc/postgresql/pg_hba.conf'

    # Logging
    log_destination = 'stderr'
    logging_collector = on
    log_directory = 'log'
    log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'
    log_statement = 'all'
    log_min_duration_statement = 0

    # Memory settings (adjust as needed)
    shared_buffers = 128MB
    effective_cache_size = 256MB

    # Other settings
    max_connections = 100
    timezone = 'UTC'
  pg_hba.conf: |
    # TYPE  DATABASE        USER            ADDRESS             METHOD
    local   all             all                                 trust
    host    all             all             127.0.0.1/32        trust
    host    all             all             ::1/128             trust

    host    all             all             10.1.0.0/16         md5
    host    all             all             0.0.0.0/0           md5
